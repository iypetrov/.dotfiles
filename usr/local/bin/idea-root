#!/bin/bash
# Run IntelliJ as root but reuse ipetrov's config, plugins, and theme

USER_HOME="/home/ipetrov"

export USER=ipetrov
export HOME="$USER_HOME"
export XDG_CONFIG_HOME="$USER_HOME/.config"
export XDG_CACHE_HOME="$USER_HOME/.cache"
export XDG_DATA_HOME="$USER_HOME/.local/share"
export IDEA_PROPERTIES="$XDG_CONFIG_HOME/JetBrains/IntelliJIdea2025.1/idea.properties"

# Inherit X11 session so GUI can start
export DISPLAY=${DISPLAY:-:0}
export XAUTHORITY=${XAUTHORITY:-/run/user/1000/.Xauthority}

# Run IntelliJ with a clean but GUI-capable environment
env -i \
  HOME="$HOME" \
  USER="$USER" \
  DISPLAY="$DISPLAY" \
  XAUTHORITY="$XAUTHORITY" \
  XDG_CONFIG_HOME="$XDG_CONFIG_HOME" \
  XDG_CACHE_HOME="$XDG_CACHE_HOME" \
  XDG_DATA_HOME="$XDG_DATA_HOME" \
  IDEA_PROPERTIES="$IDEA_PROPERTIES" \
  PATH="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin" \
  /usr/local/bin/idea "$@"
